(function(e){e.fn.square1=function(a){function t(a){img_url=a.attr("background-image"),a.css("background-image","url("+img_url+")"),img=new Image,img.onload=function(){a.next().hasClass("image_wrapper")?t(a.next()):(u.attr("images_loaded","").removeClass("loading"),p.onLoad()),a.addClass("image_loaded")},img.src=img_url,img.complete&&img.onload(),e('.wrap_placeholder[background-image="'+img_url+'"]',u).css("background-image","url("+img_url+")")}function r(){c=1,s(),_(),p.onPlay()}function i(){clearInterval(c),p.onStop()}function s(){c&&(clearInterval(c),c=setInterval(n,p.slide_duration+p.transition_time),e(u).data("interval",c))}function n(){var a=e(".current_slide",u).index();a>=e(".image_wrapper",u).length-1?d(0):e(".current_slide",u).next().hasClass("image_loaded")?d(a+1):setTimeout(function(){n()},100)}function o(){var a=e(".current_slide",u).index();d(0==a?e(".image_wrapper",u).last().index():a-1)}function d(a){e(".image_wrapper",u).finish().clearQueue(),"slide"==p.animation?(reset_slide_position=!1,target_slide=a,last_slide=e(".image_wrapper",u).last().index(),clearTimeout(v),e(".image_wrapper, .wrap_placeholder",u).removeClass("no_transition"),e(".current_slide",u).index()==last_slide&&0==a&&(reset_slide_position="first",target_slide=last_slide+1),0==e(".current_slide",u).index()&&a==last_slide&&(reset_slide_position="last",target_slide=-1),e(".current_slide",u).removeClass("current_slide"),e(".image_wrapper",u).eq(a).addClass("current_slide"),translate_target=-100*target_slide,e(".image_wrapper, .wrap_placeholder",u).css("transform","translateX("+translate_target+"%)"),"first"==reset_slide_position&&(v=setTimeout(function(){e(".image_wrapper, .wrap_placeholder",u).addClass("no_transition"),e(".image_wrapper, .wrap_placeholder",u).css("transform","translateX(0%)")},p.transition_time)),"last"==reset_slide_position&&(v=setTimeout(function(){e(".image_wrapper, .wrap_placeholder",u).addClass("no_transition"),e(".image_wrapper, .wrap_placeholder",u).css("transform","translateX(-200%)")},p.transition_time))):"cover"==p.fill_mode?a>e(".current_slide",u).index()?(e(".current_slide",u).removeClass("current_slide"),e(".image_wrapper",u).eq(a).addClass("current_slide").fadeIn(p.transition_time,function(){e(".image_wrapper:not(.current_slide)",u).hide()})):a<e(".current_slide",u).index()&&(e(".current_slide",u).removeClass("current_slide").fadeOut(p.transition_time),e(".image_wrapper",u).eq(a).addClass("current_slide").show()):(e(".current_slide",u).removeClass("current_slide").fadeOut(p.transition_time),e(".image_wrapper",u).eq(a).addClass("current_slide").fadeIn(p.transition_time)),s(),l(),_(),p.onChange()}function l(){"none"!=p.caption?e(".square1_caption",u).fadeOut(p.transition_time,function(){setTimeout(function(){e(".square1_caption",u).html(e(".current_slide img",u).attr("alt")).fadeIn(p.transition_time-200)},10)}):e(".square1_caption",u).remove()}function _(){"none"!=p.dots_nav?(e(".square1_dots span",u).removeClass("current"),e('.square1_dots span[data-image-num="'+e(".current_slide",u).index()+'"]',u).addClass("current")):e(".square1_dots",u).remove()}var c,u=this;if(!(u.length<1)){if(e(u).data("settings")){var p=e(u).data("settings");c=e(u).data("interval")}else{p=e.extend({width:"",height:"",fill_mode:"cover",scale_from:"center center",background:"none",auto_start:!0,start_delay:0,slide_duration:4e3,transition_time:500,pause_on_hover:!1,keyboard:!0,gestures:!0,theme:"dark",prev_next_nav:"inside",dots_nav:"inside",caption:"outside",onLoad:function(){},onPlay:function(){},onStop:function(){},onChange:function(){}},a);e(u).data("settings",p)}if("play"!=a){if("stop"==a)return p.auto_start=!1,void i();if("next"==a)return n(),void(p.auto_start&&s());if("prev"==a)return o(),void(p.auto_start&&s());if(Math.floor(a)===a&&+a===a)return d(a-1),void(p.auto_start&&s());e(u).css({position:"relative",width:p.width,height:p.height,background:p.background}),u.addClass("square1 loading"),p.keyboard&&!u.attr("tabindex")&&u.attr("tabindex",0),u.wrapInner('<div class="slides_container" />'),u.find(".slides_container").children().wrap('<div class="image_wrapper" />'),e(".image_wrapper",u).each(function(){if($img=e(this).find("img"),$img.prop("currentSrc"))var a=$img.prop("currentSrc");else a=$img.attr("src");e(this).attr("background-image",a),$img.removeAttr("src").remove(),$img.attr("scale-from")?e(this).css("background-position",$img.attr("scale-from")):p.scale_from&&e(this).css("background-position",p.scale_from)}),t(e(".image_wrapper:first-child",u)),e(".image_wrapper:first",u).addClass("current_slide"),e(".image_wrapper:not(.current_slide)",u).hide(),e(u).append('<div class="square1_caption"></div>'),e(u).find(".image_wrapper").length>1&&e(u).append('<div class="square1_controls"><span class="square1_prev_image">Previous Image</span><span class="square1_next_image">Next Image</span><div class="square1_dots"></div></div>'),e(u).append('<div class="square1_spinner"></div>');var m,g,f,h,v,w=0;if(e(".image_wrapper",u).each(function(){e(".square1_dots",u).append('<span data-image-num="'+w+'"></span>'),w++}),e(".square1_dots span:first-child",u).addClass("current"),"slide"==p.animation){u.addClass("slide_animation"),e(".image_wrapper, .wrap_placeholder",u).show();w=0;e(".image_wrapper, .wrap_placeholder",u).each(function(){e(this).css({left:100*w+"%",transitionDuration:p.transition_time+"ms"}),w++}),e(".image_wrapper",u).last().clone().removeClass("image_wrapper").addClass("wrap_placeholder").css({left:"-100%"}).appendTo(e(".slides_container",u)),e(".image_wrapper",u).first().clone().removeClass("image_wrapper").addClass("wrap_placeholder").css({left:"300%"}).appendTo(e(".slides_container",u))}if(e(u).addClass("fill_mode-"+p.fill_mode),e(u).addClass("theme-"+p.theme),e(u).addClass("prev_next_nav-"+p.prev_next_nav),e(u).addClass("dots_nav-"+p.dots_nav),e(u).addClass("caption-"+p.caption),e(".square1_prev_image",u).click(function(){o()}),e(".square1_next_image",u).click(function(){n()}),e(".square1_dots span",u).click(function(){d(e(this).data("image-num"))}),e(u).keydown(function(e){if(37==e.keyCode||38==e.keyCode)o();else{if(39!=e.keyCode&&40!=e.keyCode)return;n()}e.preventDefault(),e.stopPropagation()}),p.gestures)e(u).on("touchstart",function(e){m=e.touches[0].screenX,g=e.touches[0].screenY,f=new Date}),e(u).on("touchmove",function(e){h=e}),e(u).on("touchend",function(e){deltaX=h.touches[0].screenX-m,deltaY=h.touches[0].screenY-g,touchDuration=new Date-f,Math.abs(deltaX/deltaY)<2||Math.abs(deltaX)<30||touchDuration>800||(deltaX>0?o():n())});return e(u).on("mouseenter",".image_wrapper",function(){p.pause_on_hover&&i()}),e(u).on("mouseleave",".image_wrapper",function(){p.pause_on_hover&&p.auto_start&&r()}),p.auto_start&&setTimeout(r,p.start_delay),l(),u}r()}}})(jQuery);