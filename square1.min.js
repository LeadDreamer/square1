/*
* Square1 Slider
* Copyright (c) 2016 Thom Hines
* Licensed under MIT.
* @author Thom Hines
* https://github.com/thomhines/square1
* @version 0.2.1
*/


!function(e){e.fn.square1=function(t){function a(){_=1,r(),u(),c.onPlay()}function n(){clearInterval(_),c.onStop()}function r(){_&&(clearInterval(_),_=setInterval(i,c.slide_duration+c.transition_time),e(l).data("interval",_))}function i(){var t=e(".current_slide",l).index();o(t==e(".image_wrapper",l).length-1?0:t+1)}function s(){var t=e(".current_slide",l).index();o(0==t?e(".image_wrapper",l).last().index():t-1)}function o(t){e(".image_wrapper",l).finish().clearQueue(),"cover"==c.fill_mode?t>e(".current_slide",l).index()?(e(".current_slide",l).removeClass("current_slide"),e(".image_wrapper",l).eq(t).addClass("current_slide").fadeIn(c.transition_time,function(){e(".image_wrapper:not(.current_slide)",l).hide()})):t<e(".current_slide",l).index()&&(e(".current_slide",l).removeClass("current_slide").fadeOut(c.transition_time),e(".image_wrapper",l).eq(t).addClass("current_slide").show()):(e(".current_slide",l).removeClass("current_slide").fadeOut(c.transition_time),e(".image_wrapper",l).eq(t).addClass("current_slide").fadeIn(c.transition_time)),r(),d(),u(),c.onChange()}function d(){return"none"==c.caption?void e(".square1_caption",l).remove():void e(".square1_caption",l).fadeOut(c.transition_time,function(){setTimeout(function(){e(".square1_caption",l).html(e(".current_slide img",l).attr("alt")).fadeIn(c.transition_time-200)},10)})}function u(){return"none"==c.dots_nav?void e(".square1_dots",l).remove():(e(".square1_dots span",l).removeClass("current"),void e('.square1_dots span[data-image-num="'+e(".current_slide",l).index()+'"]',l).addClass("current"))}var c,_,l=this;if(!(l.length<1)){if(e(l).data("settings")){var c=e(l).data("settings");_=e(l).data("interval")}else{var c=e.extend({width:"",height:"",fill_mode:"cover",background:"none",auto_start:!0,start_delay:0,slide_duration:4e3,transition_time:500,pause_on_hover:!1,keyboard:!0,gestures:!0,theme:"dark",prev_next_nav:"inside",dots_nav:"inside",caption:"outside",onPlay:function(){},onStop:function(){},onChange:function(){}},t);e(l).data("settings",c)}if("play"==t)return void a();if("stop"==t)return c.auto_start=!1,void n();if("next"==t)return i(),void(c.auto_start&&r());if("prev"==t)return s(),void(c.auto_start&&r());if(Math.floor(t)===t&&+t===t)return o(t-1),void(c.auto_start&&r());e(l).css({position:"relative",width:c.width,height:c.height,background:c.background}),l.addClass("square1"),c.keyboard&&!l.attr("tabindex")&&l.attr("tabindex",0),e(l).children().wrap('<div class="image_wrapper" />'),e(".image_wrapper",l).each(function(){if(e(this).find("img").prop("currentSrc"))var t=e(this).find("img").prop("currentSrc");else var t=e(this).find("img").attr("src");e(this).css("background-image","url("+t+")")}),e(".image_wrapper:first",l).addClass("current_slide"),e(".image_wrapper:not(.current_slide)",l).hide(),e(l).append('<div class="square1_caption"></div>'),e(l).append('<div class="square1_controls"><span class="square1_prev_image">Previous Image</span><span class="square1_next_image">Next Image</span><div class="square1_dots"></div></div>');var p=0;if(e(".image_wrapper",l).each(function(){e(".square1_dots",l).append('<span data-image-num="'+p+'"></span>'),p++}),e(l).addClass("fill_mode-"+c.fill_mode),e(l).addClass("theme-"+c.theme),e(l).addClass("prev_next_nav-"+c.prev_next_nav),e(l).addClass("dots_nav-"+c.dots_nav),e(l).addClass("caption-"+c.caption),e(".square1_prev_image",l).click(function(){s()}),e(".square1_next_image",l).click(function(){i()}),e(".square1_dots span",l).click(function(){o(e(this).data("image-num"))}),e(l).keydown(function(e){if(37==e.keyCode||38==e.keyCode)s();else{if(39!=e.keyCode&&40!=e.keyCode)return;i()}e.preventDefault(),e.stopPropagation()}),c.gestures){var v,m,f,g;e(l).on("touchstart",function(e){v=e.touches[0].screenX,m=e.touches[0].screenY,f=new Date}),e(l).on("touchmove",function(e){g=e}),e(l).on("touchend",function(e){deltaX=g.touches[0].screenX-v,deltaY=g.touches[0].screenY-m,touchDuration=new Date-f,Math.abs(deltaX/deltaY)<2||Math.abs(deltaX)<30||touchDuration>800||(deltaX>0?s():i())})}return e(l).on("mouseenter",".image_wrapper",function(){c.pause_on_hover&&n()}),e(l).on("mouseleave",".image_wrapper",function(){c.pause_on_hover&&c.auto_start&&a()}),c.auto_start&&setTimeout(a,c.start_delay),d(),l}}}(jQuery);
