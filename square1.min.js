(function(e){e.fn.square1=function(a){function t(e){img_url=e.attr("background-image"),e.css("background-image","url("+img_url+")"),img=new Image,img.onload=function(){e.next().hasClass("image_wrapper")?t(e.next()):(m.attr("images_loaded","").removeClass("loading"),l.onLoad())},img.src=img_url,img.complete&&img.onload()}function n(){_=1,i(),c(),l.onPlay()}function r(){clearInterval(_),l.onStop()}function i(){_&&(clearInterval(_),_=setInterval(s,l.slide_duration+l.transition_time),e(m).data("interval",_))}function s(){var a=e(".current_slide",m).index();d(a==e(".image_wrapper",m).length-1?0:a+1)}function o(){var a=e(".current_slide",m).index();d(0==a?e(".image_wrapper",m).last().index():a-1)}function d(a){e(".image_wrapper",m).finish().clearQueue(),"slide"==l.animation?(e(".current_slide",m).removeClass("current_slide"),e(".image_wrapper",m).eq(a).addClass("current_slide"),translate_target=a*-100,e(".image_wrapper",m).animate({borderspacing:translate_target},{step:function(a,t){e(this).css("transform","translateX("+a+"%)")},duration:l.transition_time})):"cover"==l.fill_mode?a>e(".current_slide",m).index()?(e(".current_slide",m).removeClass("current_slide"),e(".image_wrapper",m).eq(a).addClass("current_slide").fadeIn(l.transition_time,function(){e(".image_wrapper:not(.current_slide)",m).hide()})):a<e(".current_slide",m).index()&&(e(".current_slide",m).removeClass("current_slide").fadeOut(l.transition_time),e(".image_wrapper",m).eq(a).addClass("current_slide").show()):(e(".current_slide",m).removeClass("current_slide").fadeOut(l.transition_time),e(".image_wrapper",m).eq(a).addClass("current_slide").fadeIn(l.transition_time)),i(),u(),c(),l.onChange()}function u(){return"none"==l.caption?void e(".square1_caption",m).remove():void e(".square1_caption",m).fadeOut(l.transition_time,function(){setTimeout(function(){e(".square1_caption",m).html(e(".current_slide img",m).attr("alt")).fadeIn(l.transition_time-200)},10)})}function c(){return"none"==l.dots_nav?void e(".square1_dots",m).remove():(e(".square1_dots span",m).removeClass("current"),void e('.square1_dots span[data-image-num="'+e(".current_slide",m).index()+'"]',m).addClass("current"))}var l,_,m=this;if(!(m.length<1)){if(e(m).data("settings")){var l=e(m).data("settings");_=e(m).data("interval")}else{var l=e.extend({width:"",height:"",fill_mode:"cover",scale_from:"center center",background:"none",auto_start:!0,start_delay:0,slide_duration:4e3,transition_time:500,pause_on_hover:!1,keyboard:!0,gestures:!0,theme:"dark",prev_next_nav:"inside",dots_nav:"inside",caption:"outside",onLoad:function(){},onPlay:function(){},onStop:function(){},onChange:function(){}},a);e(m).data("settings",l)}if("play"==a)return void n();if("stop"==a)return l.auto_start=!1,void r();if("next"==a)return s(),void(l.auto_start&&i());if("prev"==a)return o(),void(l.auto_start&&i());if(Math.floor(a)===a&&+a===a)return d(a-1),void(l.auto_start&&i());e(m).css({position:"relative",width:l.width,height:l.height,background:l.background}),m.addClass("square1 loading"),l.keyboard&&!m.attr("tabindex")&&m.attr("tabindex",0),e(m).children().wrap('<div class="image_wrapper" />'),e(".image_wrapper",m).each(function(){if($img=e(this).find("img"),$img.prop("currentSrc"))var a=$img.prop("currentSrc");else var a=$img.attr("src");e(this).attr("background-image",a),$img.removeAttr("src").remove(),$img.attr("scale-from")?e(this).css("background-position",$img.attr("scale-from")):l.scale_from&&e(this).css("background-position",l.scale_from)}),t(e(".image_wrapper:first-child",m)),e(".image_wrapper:first",m).addClass("current_slide"),e(".image_wrapper:not(.current_slide)",m).hide(),e(m).append('<div class="square1_caption"></div>'),e(m).append('<div class="square1_controls"><span class="square1_prev_image">Previous Image</span><span class="square1_next_image">Next Image</span><div class="square1_dots"></div></div>'),e(m).append('<div class="square1_spinner"></div>');var p=0;if(e(".image_wrapper",m).each(function(){e(".square1_dots",m).append('<span data-image-num="'+p+'"></span>'),p++}),e(".square1_dots span:first-child",m).addClass("current"),"slide"==l.animation){m.addClass("slide_animation"),e(".image_wrapper",m).show();var p=0;e(".image_wrapper",m).each(function(){e(this).css("left",100*p+"%"),p++})}if(e(m).addClass("fill_mode-"+l.fill_mode),e(m).addClass("theme-"+l.theme),e(m).addClass("prev_next_nav-"+l.prev_next_nav),e(m).addClass("dots_nav-"+l.dots_nav),e(m).addClass("caption-"+l.caption),e(".square1_prev_image",m).click(function(){o()}),e(".square1_next_image",m).click(function(){s()}),e(".square1_dots span",m).click(function(){d(e(this).data("image-num"))}),e(m).keydown(function(e){if(37==e.keyCode||38==e.keyCode)o();else{if(39!=e.keyCode&&40!=e.keyCode)return;s()}e.preventDefault(),e.stopPropagation()}),l.gestures){var g,f,v,h;e(m).on("touchstart",function(e){g=e.touches[0].screenX,f=e.touches[0].screenY,v=new Date}),e(m).on("touchmove",function(e){h=e}),e(m).on("touchend",function(e){deltaX=h.touches[0].screenX-g,deltaY=h.touches[0].screenY-f,touchDuration=new Date-v,Math.abs(deltaX/deltaY)<2||Math.abs(deltaX)<30||touchDuration>800||(deltaX>0?o():s())})}return e(m).on("mouseenter",".image_wrapper",function(){l.pause_on_hover&&r()}),e(m).on("mouseleave",".image_wrapper",function(){l.pause_on_hover&&l.auto_start&&n()}),l.auto_start&&setTimeout(n,l.start_delay),u(),m}}})(jQuery);